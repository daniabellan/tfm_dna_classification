H5 cargado desde /home/diz-wsl/personal_repos/tfm/data/ecoli_k12/pod5_1.h5 | Done in 0.9268 secs
Preprocessing done in 27.5699 secs
H5 cargado desde /home/diz-wsl/personal_repos/tfm/data/mm39/fast5.h5 | Done in 1.0284 secs
Preprocessing done in 22.7862 secs
Data loaded in 50.5469 seconds
  Mini-Batch 1/10 - Loss: 0.7295
  Elapsed time : 1.4084
  Mini-Batch 2/10 - Loss: 0.6800
  Elapsed time : 2.2875
  Mini-Batch 3/10 - Loss: 0.6425
  Elapsed time : 6.3183
  Mini-Batch 4/10 - Loss: 0.5794
  Elapsed time : 14.7846
  Mini-Batch 5/10 - Loss: 0.6294
  Elapsed time : 16.4202
  Mini-Batch 6/10 - Loss: 0.6664
  Elapsed time : 19.0180
  Mini-Batch 7/10 - Loss: 0.5630
  Elapsed time : 22.8832
  Mini-Batch 8/10 - Loss: 0.5874
  Elapsed time : 23.7503
  Mini-Batch 9/10 - Loss: 0.5571
  Elapsed time : 25.8918
  Mini-Batch 10/10 - Loss: 0.5579
  Elapsed time : 26.5590
/home/diz-wsl/anaconda3/envs/tfm/lib/python3.10/site-packages/torch/nn/modules/transformer.py:502: UserWarning: The PyTorch API of nested tensors is in prototype stage and will change in the near future. (Triggered internally at ../aten/src/ATen/NestedTensorImpl.cpp:178.)
  output = torch._nested_tensor_from_mask(
Best model saved at epoch 0 with loss: 0.6912

# ========== Train Epoch 1/100 ==========
[Train] Loss: 0.6193 | Accuracy: 0.6750 | Precision: 0.6750 | Recall: 0.6750 | F1: 0.6750
[Val]   Loss: 0.6912 | Accuracy: 0.4000 | Precision: 0.3810 | Recall: 0.4000 | F1: 0.3750
Epoch Time: 26.8970 seconds | Elapsed Time: 26.9169 seconds
  Mini-Batch 1/10 - Loss: 0.3829
  Elapsed time : 0.7148
  Mini-Batch 2/10 - Loss: 0.4638
  Elapsed time : 1.5666
  Mini-Batch 3/10 - Loss: 0.3575
  Elapsed time : 2.2204
  Mini-Batch 4/10 - Loss: 0.2879
  Elapsed time : 2.8941
  Mini-Batch 5/10 - Loss: 0.3840
  Elapsed time : 3.3466
  Mini-Batch 6/10 - Loss: 0.2528
  Elapsed time : 5.5810
  Mini-Batch 7/10 - Loss: 0.3276
  Elapsed time : 13.1346
  Mini-Batch 8/10 - Loss: 0.2216
  Elapsed time : 17.1393
  Mini-Batch 9/10 - Loss: 0.2290
  Elapsed time : 19.8791
  Mini-Batch 10/10 - Loss: 0.2052
  Elapsed time : 23.7289
Best model saved at epoch 1 with loss: 0.6826

# ========== Train Epoch 2/100 ==========
[Train] Loss: 0.3112 | Accuracy: 0.9125 | Precision: 0.9127 | Recall: 0.9125 | F1: 0.9125
[Val]   Loss: 0.6826 | Accuracy: 0.5000 | Precision: 0.2500 | Recall: 0.5000 | F1: 0.3333
Epoch Time: 24.0756 seconds | Elapsed Time: 51.0131 seconds
  Mini-Batch 1/10 - Loss: 0.1608
  Elapsed time : 8.1222
  Mini-Batch 2/10 - Loss: 0.2379
  Elapsed time : 8.6823
  Mini-Batch 3/10 - Loss: 0.3343
  Elapsed time : 9.2994
  Mini-Batch 4/10 - Loss: 0.0728
  Elapsed time : 11.8543
  Mini-Batch 5/10 - Loss: 0.0776
  Elapsed time : 14.1338
  Mini-Batch 6/10 - Loss: 0.0933
  Elapsed time : 14.9786
  Mini-Batch 7/10 - Loss: 0.0992
  Elapsed time : 15.8414
  Mini-Batch 8/10 - Loss: 0.2377
  Elapsed time : 19.6484
  Mini-Batch 9/10 - Loss: 0.1443
  Elapsed time : 23.4569
  Mini-Batch 10/10 - Loss: 0.0536
  Elapsed time : 26.2350
Best model saved at epoch 2 with loss: 0.6633

# ========== Train Epoch 3/100 ==========
[Train] Loss: 0.1512 | Accuracy: 0.9500 | Precision: 0.9511 | Recall: 0.9500 | F1: 0.9499
[Val]   Loss: 0.6633 | Accuracy: 0.5000 | Precision: 0.2500 | Recall: 0.5000 | F1: 0.3333
Epoch Time: 26.5787 seconds | Elapsed Time: 77.6109 seconds
  Mini-Batch 1/10 - Loss: 0.0396
  Elapsed time : 0.8534
  Mini-Batch 2/10 - Loss: 0.0696
  Elapsed time : 8.7633
  Mini-Batch 3/10 - Loss: 0.0224
  Elapsed time : 12.7276
  Mini-Batch 4/10 - Loss: 0.0137
  Elapsed time : 16.6058
  Mini-Batch 5/10 - Loss: 0.0340
  Elapsed time : 17.0579
  Mini-Batch 6/10 - Loss: 0.0292
  Elapsed time : 18.2558
  Mini-Batch 7/10 - Loss: 0.0267
  Elapsed time : 18.9520
  Mini-Batch 8/10 - Loss: 0.0062
  Elapsed time : 21.6851
  Mini-Batch 9/10 - Loss: 0.0032
  Elapsed time : 24.5580
  Mini-Batch 10/10 - Loss: 0.0537
  Elapsed time : 25.5149
Best model saved at epoch 3 with loss: 0.6009

# ========== Train Epoch 4/100 ==========
[Train] Loss: 0.0298 | Accuracy: 1.0000 | Precision: 1.0000 | Recall: 1.0000 | F1: 1.0000
[Val]   Loss: 0.6009 | Accuracy: 0.7000 | Precision: 0.8125 | Recall: 0.7000 | F1: 0.6703
Epoch Time: 25.8596 seconds | Elapsed Time: 103.4908 seconds
  Mini-Batch 1/10 - Loss: 0.0006
  Elapsed time : 2.4812
  Mini-Batch 2/10 - Loss: 0.0144
  Elapsed time : 10.0653
  Mini-Batch 3/10 - Loss: 0.0002
  Elapsed time : 12.7961
  Mini-Batch 4/10 - Loss: 0.0029
  Elapsed time : 16.4483
  Mini-Batch 5/10 - Loss: 0.0130
  Elapsed time : 17.3362
  Mini-Batch 6/10 - Loss: 0.0002
  Elapsed time : 19.5453
  Mini-Batch 7/10 - Loss: 0.0001
  Elapsed time : 21.2113
  Mini-Batch 8/10 - Loss: 0.0021
  Elapsed time : 24.9646
  Mini-Batch 9/10 - Loss: 0.0041
  Elapsed time : 26.6484
  Mini-Batch 10/10 - Loss: 0.0012
  Elapsed time : 27.3978
Best model saved at epoch 4 with loss: 0.5096

# ========== Train Epoch 5/100 ==========
[Train] Loss: 0.0039 | Accuracy: 1.0000 | Precision: 1.0000 | Recall: 1.0000 | F1: 1.0000
[Val]   Loss: 0.5096 | Accuracy: 0.9000 | Precision: 0.9167 | Recall: 0.9000 | F1: 0.8990
Epoch Time: 27.7218 seconds | Elapsed Time: 131.2319 seconds
  Mini-Batch 1/10 - Loss: 0.0005
  Elapsed time : 0.8380
  Mini-Batch 2/10 - Loss: 0.1034
  Elapsed time : 1.5326
  Mini-Batch 3/10 - Loss: 0.0027
  Elapsed time : 8.9899
  Mini-Batch 4/10 - Loss: 0.0002
  Elapsed time : 9.8828
  Mini-Batch 5/10 - Loss: 0.0002
  Elapsed time : 13.6054
  Mini-Batch 6/10 - Loss: 0.0001
  Elapsed time : 17.3866
  Mini-Batch 7/10 - Loss: 0.0002
  Elapsed time : 19.0862
  Mini-Batch 8/10 - Loss: 0.0001
  Elapsed time : 20.4633
  Mini-Batch 9/10 - Loss: 0.0011
  Elapsed time : 22.9594
  Mini-Batch 10/10 - Loss: 0.0032
  Elapsed time : 25.1779
Best model saved at epoch 5 with loss: 0.3787

# ========== Train Epoch 6/100 ==========
[Train] Loss: 0.0112 | Accuracy: 1.0000 | Precision: 1.0000 | Recall: 1.0000 | F1: 1.0000
[Val]   Loss: 0.3787 | Accuracy: 0.9000 | Precision: 0.9167 | Recall: 0.9000 | F1: 0.8990
Epoch Time: 25.5140 seconds | Elapsed Time: 156.7647 seconds
  Mini-Batch 1/10 - Loss: 0.0000
  Elapsed time : 1.0317
  Mini-Batch 2/10 - Loss: 0.0000
  Elapsed time : 2.6206
  Mini-Batch 3/10 - Loss: 0.0002
  Elapsed time : 3.5307
  Mini-Batch 4/10 - Loss: 0.0005
  Elapsed time : 11.0025
  Mini-Batch 5/10 - Loss: 0.0008
  Elapsed time : 13.6528
  Mini-Batch 6/10 - Loss: 0.0001
  Elapsed time : 14.5100
  Mini-Batch 7/10 - Loss: 0.0000
  Elapsed time : 18.2881
  Mini-Batch 8/10 - Loss: 0.0010
  Elapsed time : 21.9994
  Mini-Batch 9/10 - Loss: 0.0000
  Elapsed time : 24.4650
  Mini-Batch 10/10 - Loss: 0.0000
  Elapsed time : 26.6771
Best model saved at epoch 6 with loss: 0.2806

# ========== Train Epoch 7/100 ==========
[Train] Loss: 0.0003 | Accuracy: 1.0000 | Precision: 1.0000 | Recall: 1.0000 | F1: 1.0000
[Val]   Loss: 0.2806 | Accuracy: 0.9000 | Precision: 0.9167 | Recall: 0.9000 | F1: 0.8990
Epoch Time: 27.0097 seconds | Elapsed Time: 183.7935 seconds
  Mini-Batch 1/10 - Loss: 0.0000
  Elapsed time : 1.6819
  Mini-Batch 2/10 - Loss: 0.0000
  Elapsed time : 2.7812
  Mini-Batch 3/10 - Loss: 0.0004
  Elapsed time : 3.3281
  Mini-Batch 4/10 - Loss: 0.0001
  Elapsed time : 4.2334
  Mini-Batch 5/10 - Loss: 0.0000
  Elapsed time : 5.8704
  Mini-Batch 6/10 - Loss: 0.0002
  Elapsed time : 8.3508
  Mini-Batch 7/10 - Loss: 0.0000
  Elapsed time : 15.9117
  Mini-Batch 8/10 - Loss: 0.0000
  Elapsed time : 19.6401
  Mini-Batch 9/10 - Loss: 0.0000
  Elapsed time : 23.4092
  Mini-Batch 10/10 - Loss: 0.0000
  Elapsed time : 25.0771
Best model saved at epoch 7 with loss: 0.2487

# ========== Train Epoch 8/100 ==========
[Train] Loss: 0.0001 | Accuracy: 1.0000 | Precision: 1.0000 | Recall: 1.0000 | F1: 1.0000
[Val]   Loss: 0.2487 | Accuracy: 0.9000 | Precision: 0.9167 | Recall: 0.9000 | F1: 0.8990
Epoch Time: 25.4114 seconds | Elapsed Time: 209.2238 seconds
  Mini-Batch 1/10 - Loss: 0.0001
  Elapsed time : 2.5005
  Mini-Batch 2/10 - Loss: 0.0004
  Elapsed time : 3.5456
  Mini-Batch 3/10 - Loss: 0.0000
  Elapsed time : 5.2032
  Mini-Batch 4/10 - Loss: 0.0000
  Elapsed time : 7.4651
  Mini-Batch 5/10 - Loss: 0.0000
  Elapsed time : 15.0264
  Mini-Batch 6/10 - Loss: 0.0006
  Elapsed time : 15.4655
  Mini-Batch 7/10 - Loss: 0.0006
  Elapsed time : 17.0943
  Mini-Batch 8/10 - Loss: 0.0000
  Elapsed time : 20.7652
  Mini-Batch 9/10 - Loss: 0.0000
  Elapsed time : 21.6188
  Mini-Batch 10/10 - Loss: 0.0007
  Elapsed time : 22.3618
Best model saved at epoch 8 with loss: 0.2239

# ========== Train Epoch 9/100 ==========
[Train] Loss: 0.0002 | Accuracy: 1.0000 | Precision: 1.0000 | Recall: 1.0000 | F1: 1.0000
[Val]   Loss: 0.2239 | Accuracy: 0.9000 | Precision: 0.9167 | Recall: 0.9000 | F1: 0.8990
Epoch Time: 22.6846 seconds | Elapsed Time: 231.9273 seconds
  Mini-Batch 1/10 - Loss: 0.0000
  Elapsed time : 2.2067
  Mini-Batch 2/10 - Loss: 0.0000
  Elapsed time : 5.9622
  Mini-Batch 3/10 - Loss: 0.0000
  Elapsed time : 13.5322
  Mini-Batch 4/10 - Loss: 0.0000
  Elapsed time : 14.6122
  Mini-Batch 5/10 - Loss: 0.0000
  Elapsed time : 18.3874
  Mini-Batch 6/10 - Loss: 0.0000
  Elapsed time : 19.2106
  Mini-Batch 7/10 - Loss: 0.0000
  Elapsed time : 21.9333
  Mini-Batch 8/10 - Loss: 0.0002
  Elapsed time : 22.5925
  Mini-Batch 9/10 - Loss: 0.0003
  Elapsed time : 23.1292
  Mini-Batch 10/10 - Loss: 0.0000
  Elapsed time : 23.8203
Best model saved at epoch 9 with loss: 0.1692

# ========== Train Epoch 10/100 ==========
[Train] Loss: 0.0001 | Accuracy: 1.0000 | Precision: 1.0000 | Recall: 1.0000 | F1: 1.0000
[Val]   Loss: 0.1692 | Accuracy: 0.9000 | Precision: 0.9167 | Recall: 0.9000 | F1: 0.8990
Epoch Time: 24.1448 seconds | Elapsed Time: 256.0915 seconds
  Mini-Batch 1/10 - Loss: 0.0000
  Elapsed time : 2.4191
  Mini-Batch 2/10 - Loss: 0.0000
  Elapsed time : 9.9618
  Mini-Batch 3/10 - Loss: 0.0000
  Elapsed time : 13.6413
  Mini-Batch 4/10 - Loss: 0.0000
  Elapsed time : 17.4268
  Mini-Batch 5/10 - Loss: 0.0001
  Elapsed time : 19.0924
  Mini-Batch 6/10 - Loss: 0.0001
  Elapsed time : 20.1714
  Mini-Batch 7/10 - Loss: 0.0000
  Elapsed time : 22.3265
  Mini-Batch 8/10 - Loss: 0.0002
  Elapsed time : 24.0239
  Mini-Batch 9/10 - Loss: 0.0000
  Elapsed time : 26.7787
  Mini-Batch 10/10 - Loss: 0.1080
  Elapsed time : 27.4984

# ========== Train Epoch 11/100 ==========
[Train] Loss: 0.0108 | Accuracy: 0.9875 | Precision: 0.9878 | Recall: 0.9875 | F1: 0.9875
[Val]   Loss: 0.2141 | Accuracy: 0.9000 | Precision: 0.9167 | Recall: 0.9000 | F1: 0.8990
Epoch Time: 27.7029 seconds | Elapsed Time: 283.8124 seconds
  Mini-Batch 1/10 - Loss: 0.0018
  Elapsed time : 2.2083
  Mini-Batch 2/10 - Loss: 0.0182
  Elapsed time : 3.9327
  Mini-Batch 3/10 - Loss: 0.0000
  Elapsed time : 5.6218
  Mini-Batch 4/10 - Loss: 0.0000
  Elapsed time : 13.1713
  Mini-Batch 5/10 - Loss: 0.0002
  Elapsed time : 16.9373
  Mini-Batch 6/10 - Loss: 0.0000
  Elapsed time : 18.5305
  Mini-Batch 7/10 - Loss: 0.0000
  Elapsed time : 22.1799
  Mini-Batch 8/10 - Loss: 0.0245
  Elapsed time : 24.7054
  Mini-Batch 9/10 - Loss: 0.0000
  Elapsed time : 25.7287
  Mini-Batch 10/10 - Loss: 0.0000
  Elapsed time : 26.3955

# ========== Train Epoch 12/100 ==========
[Train] Loss: 0.0045 | Accuracy: 1.0000 | Precision: 1.0000 | Recall: 1.0000 | F1: 1.0000
[Val]   Loss: 0.2347 | Accuracy: 0.9000 | Precision: 0.9167 | Recall: 0.9000 | F1: 0.8990
Epoch Time: 26.6017 seconds | Elapsed Time: 310.4337 seconds
  Mini-Batch 1/10 - Loss: 0.0000
  Elapsed time : 3.7558
  Mini-Batch 2/10 - Loss: 0.0000
  Elapsed time : 4.5764
  Mini-Batch 3/10 - Loss: 0.0000
  Elapsed time : 8.3800
  Mini-Batch 4/10 - Loss: 0.0001
  Elapsed time : 9.2983
  Mini-Batch 5/10 - Loss: 0.0000
  Elapsed time : 16.8429
  Mini-Batch 6/10 - Loss: 0.0000
  Elapsed time : 18.5265
  Mini-Batch 7/10 - Loss: 0.0000
  Elapsed time : 20.7478
  Mini-Batch 8/10 - Loss: 0.0000
  Elapsed time : 21.7782
  Mini-Batch 9/10 - Loss: 0.0006
  Elapsed time : 22.5446
  Mini-Batch 10/10 - Loss: 0.0000
  Elapsed time : 23.9532

# ========== Train Epoch 13/100 ==========
[Train] Loss: 0.0001 | Accuracy: 1.0000 | Precision: 1.0000 | Recall: 1.0000 | F1: 1.0000
[Val]   Loss: 0.3517 | Accuracy: 0.8000 | Precision: 0.8571 | Recall: 0.8000 | F1: 0.7917
Epoch Time: 24.1576 seconds | Elapsed Time: 334.6096 seconds
  Mini-Batch 1/10 - Loss: 0.0001
  Elapsed time : 0.6434
  Mini-Batch 2/10 - Loss: 0.0000
  Elapsed time : 1.6660
  Mini-Batch 3/10 - Loss: 0.0000
  Elapsed time : 3.2879
  Mini-Batch 4/10 - Loss: 0.0000
  Elapsed time : 7.0024
  Mini-Batch 5/10 - Loss: 0.0000
  Elapsed time : 9.2705
  Mini-Batch 6/10 - Loss: 0.0000
  Elapsed time : 11.7215
  Mini-Batch 7/10 - Loss: 0.0000
  Elapsed time : 14.4552
  Mini-Batch 8/10 - Loss: 0.0006
  Elapsed time : 22.0100
  Mini-Batch 9/10 - Loss: 0.0000
  Elapsed time : 23.6374
  Mini-Batch 10/10 - Loss: 0.0000
  Elapsed time : 24.5224

# ========== Train Epoch 14/100 ==========
[Train] Loss: 0.0001 | Accuracy: 1.0000 | Precision: 1.0000 | Recall: 1.0000 | F1: 1.0000
[Val]   Loss: 0.3319 | Accuracy: 0.8000 | Precision: 0.8571 | Recall: 0.8000 | F1: 0.7917
Epoch Time: 24.7236 seconds | Elapsed Time: 359.3514 seconds
  Mini-Batch 1/10 - Loss: 0.0000
  Elapsed time : 0.7869
  Mini-Batch 2/10 - Loss: 0.0000
  Elapsed time : 3.4964
  Mini-Batch 3/10 - Loss: 0.0000
  Elapsed time : 11.0701
  Mini-Batch 4/10 - Loss: 0.0025
  Elapsed time : 11.6833
  Mini-Batch 5/10 - Loss: 0.0000
  Elapsed time : 15.4412
  Mini-Batch 6/10 - Loss: 0.0421
  Elapsed time : 19.1064
  Mini-Batch 7/10 - Loss: 0.0000
  Elapsed time : 20.1704
  Mini-Batch 8/10 - Loss: 0.0070
  Elapsed time : 21.7809
  Mini-Batch 9/10 - Loss: 0.0000
  Elapsed time : 22.6550
  Mini-Batch 10/10 - Loss: 1.4491
  Elapsed time : 23.4982

# ========== Train Epoch 15/100 ==========
[Train] Loss: 0.1501 | Accuracy: 0.9500 | Precision: 0.9544 | Recall: 0.9500 | F1: 0.9498
[Val]   Loss: 0.2415 | Accuracy: 0.9000 | Precision: 0.9167 | Recall: 0.9000 | F1: 0.8990
Epoch Time: 23.7046 seconds | Elapsed Time: 383.0743 seconds
Early stopping triggered

** Training done in 383.0743 seconds

Confusion Matrix:
[[5 0]
 [0 5]]

# ========== Test ==========
Loss: 0.1861 | Accuracy: 1.0000 | Precision: 1.0000 | Recall: 1.0000 | F1: 1.0000
Test done in 0.2803 seconds

🏃 View run run_2025-02-06T23-10-24 at: http://127.0.0.1:5000/#/experiments/119160933069470143/runs/8910a3081277411788459a0c6a5bf218
🧪 View experiment at: http://127.0.0.1:5000/#/experiments/119160933069470143
